<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="product">
	<resultMap type="product" id="productMap">
		<result column="product_no" property="productNo" />
		<result column="product_title" property="productTitle" />
		<result column="product_enrolldate" property="productEnrollDate" />
		<result column="product_update" property="productUpdate" />
		<result column="product_profile" property="productProfile" />
		<result column="product_comment" property="productComment" />
		<result column="product_state" property="productState" />
		<result column="product_step" property="productStep" />
		<result column="product_price" property="productPrice" />
		<result column="product_max" property="productMax" />
		<result column="product_min" property="productMin" />
		<result column="product_enddate" property="productEndDate" />
		<result column="sc_no" property="scNo" />
		<result column="bc_no" property="bcNo" />
		<result column="brand_no" property="brandNo" />
		<result column="member_no" property="memberNo" />
		<result column="admin_no" property="adminNo" />
		<result column="product_totalsell" property="productTotalSell" />
		<result column="product_cursell" property="productCurSell" />		
		<result column="product_qty" property="productQty" />
		<result column="product_discount" property="productDiscount" />
	</resultMap>

	<!-- JOIN PRODUCT_DETAIL USING(PRODUCT_NO) -->
	<select id="selectProductList" resultMap="productMap" parameterType="string">
		SELECT * FROM PRODUCT where BC_NO = #{category}
	</select>

	<select id="selectProductCount" resultType="_int">
		SELECT COUNT(*) FROM PRODUCT where BC_NO = #{category}
	</select> <!-- where BC_NO = #{category} -->
	
	<select id="selectProduct" parameterType="string" resultType="map">
		SELECT P.BC_NO, P.PRODUCT_TITLE, B.BRAND_TITLE, P.PRODUCT_MAX, P.PRODUCT_MIN, P.PRODUCT_QTY, P.PRODUCT_PRICE, P.PRODUCT_COMMENT, P.PRODUCT_PROFILE, PI.PRODUCT_SUBIMG , B.BRAND_NO, P.PRODUCT_NO
		FROM PRODUCT P
		JOIN BRAND B ON(B.BRAND_NO=P.BRAND_NO)
		JOIN PRODUCT_IMG PI ON(P.PRODUCT_NO=PI.PRODUCT_NO)
		WHERE P.PRODUCT_NO = #{productNo}
	</select>
	
	<select id="selectCategory" parameterType="string" resultType="map">
		select bc_title, sc_title, product_title, p.bc_no, p.sc_no 
		from product p
		join big_category b on(b.bc_no=p.bc_no)
		join small_category s on(s.sc_no=p.sc_no)
		where product_no =  #{productNo}
	</select>
	
	<resultMap type="wish" id="wishMap">
		<result column="product_no" property="productNo"/>
		<result column="member_no" property="memberNo"/>
		<result column="wish_state" property="wishState"/>
	</resultMap>
	
	<select id="selectWish" parameterType="wish" resultMap="wishMap">
		SELECT * FROM WISH WHERE PRODUCT_NO=#{productNo} AND MEMBER_NO=#{memberNo}
	</select>
	
	<insert id="insertWish" parameterType="map">
		INSERT INTO WISH VALUES(#{productNo}, #{memberNo}, DEFAULT)
	</insert>
	
	<select id="selectBcTitle" parameterType="string" resultType="string">
		SELECT BC_TITLE FROM BIG_CATEGORY WHERE BC_NO = #{bcNo} 
	</select>
	
</mapper>